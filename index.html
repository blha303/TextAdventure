<style>
body {
background-color:black;
}

form.container {
width:640px;
height:480px;
font-family:monospace;
background-color:white;
text-align:left;
overflow:scroll;
}

div#top {
margin:0;
background-color:black;
width:640px;
color:white;
}

input#textentry {
font-family:monospace;
background:0;
border:0;
display:inline;
outline:0;
padding:0;
width:600px;
font-size:inherit;
margin-top: 15px;
}
div.textblock {
margin-top: 15px;
margin-bottom: 0px;
}
</style>
<script>
var root = window.location.protocol + "//" + window.location.hostname + "/";
var input_history = [];
var input_history_curpos = 0;
function httpGetAsync(theUrl, callback)
{
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function() { 
        if (xmlHttp.readyState == 4) {
            if (xmlHttp.status == 200) callback(xmlHttp.responseText);
            else callback("Command not recognized.");
        }
    }
    xmlHttp.open("GET", theUrl, true); 
    xmlHttp.send(null);
}

function add_text_block(text) {
	elem = document.createElement("div");
	elem.className = "textblock";
	elem.innerHTML = text;
	document.getElementsByTagName("form")[0].insertBefore(elem,document.getElementById("inputblock"));
	document.getElementById("inputblock").scrollIntoView();
}

function submit_handler() {
	form = document.getElementsByTagName("form")[0];
	input_history.push(document.getElementById("textentry").value);
	input_history_curpos = input_history.length-1;
	document.getElementById("textentry").value = "";
	// Command feedback
	e1 = document.createElement("div");
	e1.className = "textblock";
	t1 = document.createTextNode("> " + input_history[input_history_curpos]);
	e1.appendChild(t1);
	form.insertBefore(e1,document.getElementById("inputblock"));
	document.getElementById("inputblock").scrollIntoView();
	// Command output
	httpGetAsync(root + input_history[input_history_curpos] + ".txt", add_text_block);
}

window.onload = function() {
	httpGetAsync(root + "location.txt", function(resp){
		document.getElementById("top").innerHTML = resp;
	});
	httpGetAsync(root + "l.txt", add_text_block);
};
document.onkeydown = function(e) {
	e = e || window.event;
	input = document.getElementById("textentry");
	if (e.keyCode == "38" && document.activeElement === input && input_history_curpos > 0) {
		input_history_curpos -= 1;
		input.value = input_history[input_history_curpos];
		setTimeout(function(){ input.selectionStart = input.selectionEnd = 10000; }, 0);
	}
	if (e.keyCode == "40" && document.activeElement === input && input_history_curpos < input_history.length-1) {
		input_history_curpos += 1;
		input.value = input_history[input_history_curpos];
		setTimeout(function(){ input.selectionStart = input.selectionEnd = 10000; }, 0);
	}
}
</script>
<body onload="document.getElementById('textentry').focus()">
<center>
<form class="container" onsubmit="submit_handler(); return false">
<div id="top"></div>
<div class="textblock">Welcome to HOME.<br>
Release 1 / Serial number 123456 / CSS v6.14 Library 6/7</div>
<div id="inputblock">&gt;&nbsp;<input id="textentry" autocomplete=off></div>
</form>
</center>
</body>
